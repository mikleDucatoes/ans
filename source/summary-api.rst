Использование API
==================

Перед началом использования REST API iWine необходимо сформировать:
 #. Подключить iWine к WIFI сети.
 #. Узнать присвоенный iWine IP адрес в формате IPv4, так как IP-адрес используется при дальнейшем обращении к устройству.
 #. Сгенерировать удостоверяющую подпись – Sig для использования в вызовах API.

Для вызова нужной функции API интерфейса, возможно, использовать любое приложение, в том числе и мобильное. Проверить доступность метода, возможно набрав в адресной строке браузера:
 ::
 
   http://ip_адрес_присвоенный_iWine/api

Выше представленный адрес представляет собой URL, к которому добавляете с некоторым набором параметров. Вас следует выбрать из списка (*) нужный метод, getVolume(‘pr’,Sig), формируете запрос согласно документации метода, и осуществляете этот запрос. В ответ на запрос вы получаете результат выполнения функции, либо код ошибки. Кодировка результата – UTF-8.
Например, на РНР для осуществления такого запроса можно использовать cURL, на Perl – LWP::Simple, на Python – urllib, использовать из командной строки bash cUrl или браузер.
Как правило, для каждого современного языка программирования существуют готовые библиотеки, в которых есть реализация REST API.
Данные запроса могут предоставляться в виде query-строки (после знака ?) при использовании метода GET, либо в теле POST-запроса. Обратите внимание, что в случае GET-запроса, параметры должны быть закодированы с помощью URL encoding.
На данный момент, API не делает различий между GET- и POST-запросами. Тем не менее, помните, что существует ограничение на длину URL запроса — 2048 символов. Поэтому мы рекомендуем вам выполнять запросы на получение информации с помощью метода GET (они обычно легко умещаются в ограничение), а запросы на изменение состояния налитого вина в iWine — подогрев, охлаждение, взбалтывание вина для насыщения воздухом — с помощью метода POST. Так вы не будете ограничены длиной запроса, кроме того, такое использование больше соответствует спецификации протокола HTTP.

 .. attention::
 
   Набранный адрес в адресной строке браузера должен соответствовать URL-кодировке и структуре URL:
 
  ::
 
   <схема>:[//[<логин>[:<пароль>]@]<хост>[:<порт>]][/<URL-путь>][?<параметры>][#<якорь>]
   
  В этой записи:
    
  - :схема: схема обращения к ресурсу, в нашем случае - сетевой протокол
  - :логин: имя пользователя, используемое для доступа к ресурсу, в нашем случае - не используется
  - :пароль: пароль указанного пользователя, в нашем случае - не используется
  - :хост: полностью прописанное доменное имя хоста в системе DNS или IP-адрес хоста в форме четырёх групп десятичных чисел (в нашем случае), разделённых точками; числа — целые в интервале от 0 до 255
  - :порт: порт хоста для подключения, в нашем случае - 80 (по умолчанию указан в настройках)
  - :URL-путь: уточняющая информация о месте нахождения ресурса, в нашем случае - ``/api``
  - :?<параметры>: строка запроса с передаваемыми на сервер (методом GET) параметрами. Начинается с символа ?, разделитель параметров — знак &.
  - :#<якорь>: заголовок внутри документа или атрибут id (англ.)русск. элемента. По такой ссылке браузер откроет страницу и переместит окно к указанному элементу. В нашем случае не используется.

 Удобство предложенного разработчиками iWine подхода состоит в том, что:
  #. функции разделены на две категории: управляющие (подогреть, остудить, взболтать) и информационные (наполнение, температура, тип вина, содержание алкоголя и сахара).
  #. каждая функция имеет одним из передаваемых параметров подпись - Sig.
  #. используются хорошодо кументированные коды ответов web-сервера по протоколу http_. 
   .. _HTTP : https://ru.wikipedia.org/wiki/HTTP